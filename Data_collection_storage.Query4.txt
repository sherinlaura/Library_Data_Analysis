SELECT DISTINCT
    name_store AS store_name,
    category,
    date_upd AS sale_date,
    name,
    price,
    RANK() OVER (PARTITION BY name_store, category ORDER BY price) AS price_rank
FROM
    products_data_all
WHERE
    date_upd = '2019-06-02'
ORDER BY
    store_name,
    category,
    price_rank;